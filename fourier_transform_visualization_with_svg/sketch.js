

//Santhosh Jallu
const USER = 0;
const FOURIER = 1;

let time = 0;
let path =  [];
let dd =[];
let fourierX;

let svgdata = [{x: 163, y: 372},
  {x: 183.3701171875, y: 372},
  {x: 203.740234375, y: 372},
  {x: 191.48712158203125, y: 358.48712158203125},
  {x: 177.83335876464844, y: 343.385986328125},
  {x: 162.90982055664062, y: 333.56622314453125},
  {x: 145.6395721435547, y: 343.6585388183594},
  {x: 130.31675720214844, y: 357.0186462402344},
  {x: 116.74185180664062, y: 372.1985778808594},
  {x: 100.49138641357422, y: 384.4766540527344},
  {x: 83.84965515136719, y: 396.2237854003906},
  {x: 67.51121520996094, y: 403.6576232910156},
  {x: 52.802162170410156, y: 389.60430908203125},
  {x: 43.69236755371094, y: 371.3847351074219},
  {x: 35.07255935668945, y: 352.9366760253906},
  {x: 26.973247528076172, y: 334.2459716796875},
  {x: 23.05358123779297, y: 314.3215026855469},
  {x: 59.37323760986328, y: 256.9029541015625},
  {x: 40.4433708190918, y: 264.4263610839844},
  {x: 33.159202575683594, y: 282.887451171875},
  {x: 26.836284637451172, y: 302.25140380859375},
  {x: 85.44435119628906, y: 246.54135131835938},
  {x: 104.37422180175781, y: 239.0179443359375},
  {x: 27.948955535888672, y: 309.3603515625},
  {x: 43.34510803222656, y: 296.103271484375},
  {x: 60.2940673828125, y: 284.803955078125},
  {x: 76.97286224365234, y: 273.1632080078125},
  {x: 91.88162994384766, y: 259.2826232910156},
  {x: 106.59422302246094, y: 245.2062225341797},
  {x: 75.67118072509766, y: 244.9879150390625},
  {x: 65.8046646118164, y: 227.1825714111328},
  {x: 62, y: 207.8896484375},
  {x: 68.16026306152344, y: 188.5192108154297},
  {x: 106.71000671386719, y: 223.7100067138672},
  {x: 92.30615234375, y: 209.30615234375},
  {x: 79.04747009277344, y: 193.85696411132812},
  {x: 201.3377227783203, y: 103.48231506347656},
  {x: 215.5035400390625, y: 118.12032318115234},
  {x: 199.4859161376953, y: 101.92461395263672},
  {x: 212.6785888671875, y: 117.44540405273438},
  {x: 227.95851135253906, y: 129.12135314941406},
  {x: 243.3280792236328, y: 115.78485870361328},
  {x: 259.6800537109375, y: 103.63766479492188},
  {x: 241.15243530273438, y: 117.66753387451172},
  {x: 258.4724426269531, y: 106.94562530517578},
  {x: 273.6103515625, y: 93.36181640625},
  {x: 195.1911163330078, y: 96.51277923583984},
  {x: 183.20999145507812, y: 80.03873443603516},
  {x: 271.7238464355469, y: 70.23881530761719},
  {x: 252.20326232910156, y: 76.057861328125},
  {x: 244.43235778808594, y: 69.82705688476562},
  {x: 254.85731506347656, y: 53.83354187011719},
  {x: 240.9602813720703, y: 55.03971481323242},
  {x: 223.4488525390625, y: 64.56405639648438},
  {x: 206.70571899414062, y: 75.29428100585938},
  {x: 191.05738830566406, y: 82.02869415283203},
  {x: 175.4987030029297, y: 69.7188720703125},
  {x: 163.21893310546875, y: 53.466224670410156},
  {x: 150.93914794921875, y: 37.21357345581055},
  {x: 139.4994354248047, y: 20.37411880493164},
  {x: 128.45623779296875, y: 3.2571754455566406},
  {x: 65.21393585205078, y: 178.59681701660156},
  {x: 50.222930908203125, y: 164.8050994873047},
  {x: 36.23152160644531, y: 150.0358123779297},
  {x: 23, y: 134.65869140625},
  {x: 23, y: 114.28857421875},
  {x: 107.3100814819336, y: 13.215896606445312},
  {x: 90.97236633300781, y: 25.382278442382812},
  {x: 74.63485717773438, y: 37.54851531982422},
  {x: 59.34803009033203, y: 50.97205352783203},
  {x: 44.47740936279297, y: 64.89348602294922},
  {x: 29.606788635253906, y: 78.81492614746094},
  {x: 23, y: 96.320068359375},
  {x: 117, y: 16.68994140625},
  {x: 117, y: 37.06005859375},
  {x: 35.580665588378906, y: 95.43224334716797},
  {x: 51.28433609008789, y: 82.46210479736328},
  {x: 67.4027099609375, y: 70.00699615478516},
  {x: 83.99874877929688, y: 58.20087814331055},
  {x: 101.75328063964844, y: 48.34101486206055},
  {x: 292.2529296875, y: 120.94609832763672},
  {x: 278.5414123535156, y: 136.010498046875},
  {x: 129.7556610107422, y: 45.78337097167969},
  {x: 142.3773651123047, y: 61.066036224365234},
  {x: 152.5205078125, y: 78.69599151611328},
  {x: 161.86312866210938, y: 96.79729461669922},
  {x: 171.00125122070312, y: 115.00251770019531},
  {x: 180.11093139648438, y: 133.22189331054688},
  {x: 194.83392333984375, y: 147.1046905517578},
  {x: 211.35093688964844, y: 158.59811401367188},
  {x: 230.2043914794922, y: 163.68911743164062},
  {x: 249.0533905029297, y: 155.9679718017578},
  {x: 266.5206298828125, y: 145.4876251220703},
  {x: 286.72540283203125, y: 127.00204467773438},
  {x: 280.1851806640625, y: 76.16049194335938},
  {x: 296.8077087402344, y: 64.3862075805664},
  {x: 312.1950378417969, y: 51.122047424316406},
  {x: 326.84930419921875, y: 36.97307586669922},
  {x: 342.49383544921875, y: 23.975311279296875},
  {x: 359.6925048828125, y: 13.167731285095215},
  {x: 373.6224060058594, y: 27.670272827148438},
  {x: 296.0754089355469, y: 116.81554412841797},
  {x: 310.10516357421875, y: 102.04723358154297},
  {x: 324.91766357421875, y: 88.07548522949219},
  {x: 339.8139343261719, y: 74.18607330322266},
  {x: 354.2177734375, y: 59.7822265625},
  {x: 370.905517578125, y: 48.547237396240234},
  {x: 387.98883056640625, y: 43.87275314331055},
  {x: 398.72491455078125, y: 61.13943099975586},
  {x: 407.5025634765625, y: 79.42902374267578},
  {x: 411.6296691894531, y: 99.37667846679688},
  {x: 420.86474609375, y: 117.10319519042969},
  {x: 432.4985656738281, y: 133.8213348388672},
  {x: 443.6460266113281, y: 150.87039184570312},
  {x: 447, y: 170.2413330078125},
  {x: 436.66815185546875, y: 186.33184814453125},
  {x: 420.65521240234375, y: 198.68812561035156},
  {x: 403.3521728515625, y: 209.431884765625},
  {x: 386.4032897949219, y: 220.73114013671875},
  {x: 369.0921630859375, y: 231.46676635742188},
  {x: 351.87493896484375, y: 242.35231018066406},
  {x: 346.2784729003906, y: 257.28900146484375},
  {x: 353.28125, y: 276.4166564941406},
  {x: 348.5250244140625, y: 290},
  {x: 337.71124267578125, y: 250.48883056640625},
  {x: 321.8062438964844, y: 262.1293640136719},
  {x: 338.77978515625, y: 296.7657775878906},
  {x: 322.1294860839844, y: 285.5340270996094},
  {x: 347.0170593261719, y: 304.02130126953125},
  {x: 356.682373046875, y: 321.40240478515625},
  {x: 361.4453125, y: 341.203125},
  {x: 367.2416687011719, y: 360.7249755859375},
  {x: 313, y: 283.485107421875},
  {x: 319.5989990234375, y: 302.18280029296875},
  {x: 329.09942626953125, y: 320.1988525390625},
  {x: 338.91192626953125, y: 337.91192626953125},
  {x: 353.3157653808594, y: 352.3157653808594},
  {x: 366.95068359375, y: 367.44451904296875},
  {x: 380.13873291015625, y: 382.9664611816406},
  {x: 380.5020446777344, y: 399.774169921875},
  {x: 365.89508056640625, y: 413.185546875},
  {x: 349.26544189453125, y: 424.9342346191406},
  {x: 332.5708312988281, y: 436.56427001953125},
  {x: 314.8929748535156, y: 446.6829833984375},
  {x: 296.9817810058594, y: 456.3848571777344},
  {x: 277.5279541015625, y: 453.8819885253906},
  {x: 259.5693664550781, y: 444.5693664550781},
  {x: 245.70596313476562, y: 429.6924133300781},
  {x: 207.38587951660156, y: 375.687255859375},
  {x: 218.45196533203125, y: 392.7893981933594},
  {x: 233.0648651123047, y: 413.41259765625},
  {x: 122.98662567138672, y: 380.9799499511719},
  {x: 225.23033142089844, y: 407.4974060058594},
  {x: 208.99874877929688, y: 419.647705078125},
  {x: 190.2064208984375, y: 426},
  {x: 171.0149383544922, y: 421.0074768066406},
  {x: 153.5984649658203, y: 410.53643798828125},
  {x: 136.94012451171875, y: 398.81439208984375},
  {x: 133, y: 411.52801513671875},
  {x: 133, y: 431.8980712890625},
  {x: 133, y: 452.26812744140625},
  {x: 236, y: 436.63824462890625},
  {x: 236, y: 457.00830078125},
  {x: 146.5406951904297, y: 457.8359680175781},
  {x: 166.34164428710938, y: 462.60516357421875},
  {x: 186.10804748535156, y: 467.5270080566406},
  {x: 206.2967529296875, y: 469},
  {x: 226.22047424316406, y: 465.6671447753906},
  {x: 123.84696960449219, y: 448.4234924316406},
  {x: 105.13259887695312, y: 440.43560791015625},
  {x: 84.99740600585938, y: 441.2506408691406},
  {x: 65.08892822265625, y: 445},
  {x: 45.03117370605469, y: 446.3970947265625},
  {x: 28.22296142578125, y: 456.99200439453125},
  {x: 16.590347290039062, y: 473.7138671875},
  {x: 3.420041084289551, y: 489.2342529296875},
  {x: 12.805130958557129, y: 503.8051452636719},
  {x: 27.739044189453125, y: 517.6016845703125},
  {x: 43.956912994384766, y: 529.92724609375},
  {x: 62.31819534301758, y: 538.3693237304688},
  {x: 81.41339111328125, y: 545.4583740234375},
  {x: 100.78988647460938, y: 551.74267578125},
  {x: 120.1741943359375, y: 558.0023803710938},
  {x: 139.59872436523438, y: 564.1364135742188},
  {x: 159.1647186279297, y: 569.6753540039062},
  {x: 179.27210998535156, y: 572.93603515625},
  {x: 199.47589111328125, y: 575},
  {x: 219.845947265625, y: 575},
  {x: 240.1644287109375, y: 574.3424682617188},
  {x: 260.28521728515625, y: 571.1654663085938},
  {x: 279.99261474609375, y: 566.5203247070312},
  {x: 298.81488037109375, y: 558.7317504882812},
  {x: 317.0442199707031, y: 549.6725463867188},
  {x: 332.93878173828125, y: 537.430419921875},
  {x: 333.34552001953125, y: 519.1129150390625},
  {x: 323.90228271484375, y: 501.2749938964844},
  {x: 311.587158203125, y: 485.1596374511719},
  {x: 295.4979248046875, y: 473.8118896484375},
  {x: 275.8152770996094, y: 469},
  {x: 255.44520568847656, y: 469},]


function setup() {
  createCanvas(600,600);
  for(let i=0; i< svgdata.length;i ++){
    dd.push(new Complex(svgdata[i].x - width / 2, svgdata[i].y- height / 2))  
  }
    
  fourierX = DFT(dd);
  //fourierY = DFT(y);
  fourierX.sort((a,b) => b.amplitude - a.amplitude);
  
}

function epiCycles(x, y, rotation, fourier){
  for(let i = 0; i< fourier.length; i++){
    let prevx = x;
    let prevy = y;
    let freq = fourier[i].freq;
    let radius = fourier[i].amplitude;
    let phase = fourier[i].phase;
    
    x += radius * cos( freq * time + phase + rotation) ;
    y += radius * sin( freq * time + phase + rotation) ;
    
    stroke(255,100);
    noFill();
    ellipse(prevx,prevy, radius * 2);

    stroke(0,255,0,100);
    //ellipse(x,y,2);
    line(prevx, prevy, x, y);
  }
  return createVector(x,y);
}

function draw() {
  background(0);
  
  // stroke(255);
  // noFill();
  // beginShape();
  // for(let v of svgdata){
  //   vertex(v.x+ width / 2, v.y+ height / 2);
  // },
  // endShape();

  
  let v = epiCycles(width / 2, height / 2,0, fourierX);
  
  path.unshift(v);

  
  beginShape();
  noFill();
  stroke('#03fca5');
  for(let i = 0; i< svgdata.length; i++){
    vertex(svgdata[i].x ,svgdata[i].y);
  }
  endShape(); 

  const dt = (TWO_PI / fourierX.length);

  time += dt;

  if (time > TWO_PI) {
      time = 0;
      path = [];
    }

  }
